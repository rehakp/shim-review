--- a/grub-core/normal/auth.c	2021-03-25 08:39:05.930000000 +0100
+++ b/grub-core/normal/auth.c	2021-05-18 15:41:11.830000000 +0200
@@ -240,6 +240,7 @@ grub_auth_check_authentication (const ch
   if (is_authenticated (userlist))
     {
       punishment_delay = 1;
+      grub_env_set ("current_user", login);
       return GRUB_ERR_NONE;
     }
 
